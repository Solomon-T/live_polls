!function(context,factory){"use strict";if("function"==typeof define&&define.amd)define([],factory);else if("object"==typeof exports)module.exports=factory();else{var namespace="hopscotch";if(context[namespace])return;context[namespace]=factory()}}(this,function(){var HopscotchBubble,HopscotchCalloutManager,HopscotchI18N,customI18N,customRenderer,customEscape,utils,callbacks,helpers,winLoadHandler,defaultOpts,winHopscotch,templateToUse="bubble_default",Sizzle=window.Sizzle||null,undefinedStr="undefined",waitingToStart=!1,hasJquery=typeof jQuery!==undefinedStr,hasSessionStorage=!1,isStorageWritable=!1,document=window.document,validIdRegEx=/^[a-zA-Z]+[a-zA-Z0-9_-]*$/,rtlMatches={left:"right",right:"left"};try{typeof window.sessionStorage!==undefinedStr&&(hasSessionStorage=!0,sessionStorage.setItem("hopscotch.test.storage","ok"),sessionStorage.removeItem("hopscotch.test.storage"),isStorageWritable=!0)}catch(err){}return defaultOpts={smoothScroll:!0,scrollDuration:1e3,scrollTopMargin:200,showCloseButton:!0,showPrevButton:!1,showNextButton:!0,bubbleWidth:280,bubblePadding:15,arrowWidth:20,skipIfNoElement:!0,isRtl:!1,cookieName:"hopscotch.tour.state"},Array.isArray||(Array.isArray=function(obj){return"[object Array]"===Object.prototype.toString.call(obj)}),winLoadHandler=function(){waitingToStart&&winHopscotch.startTour()},(utils={addClass:function(domEl,classToAdd){var domClasses,classToAddArr,i,len;if(domEl.className){for(classToAddArr=classToAdd.split(/\s+/),domClasses=" "+domEl.className+" ",i=0,len=classToAddArr.length;i<len;++i)domClasses.indexOf(" "+classToAddArr[i]+" ")<0&&(domClasses+=classToAddArr[i]+" ");domEl.className=domClasses.replace(/^\s+|\s+$/g,"")}else domEl.className=classToAdd},removeClass:function(domEl,classToRemove){var domClasses,classToRemoveArr,i,len;for(classToRemoveArr=classToRemove.split(/\s+/),domClasses=" "+domEl.className+" ",i=0,len=classToRemoveArr.length;i<len;++i)domClasses=domClasses.replace(" "+classToRemoveArr[i]+" "," ");domEl.className=domClasses.replace(/^\s+|\s+$/g,"")},hasClass:function(domEl,classToCheck){return!!domEl.className&&-1!==(" "+domEl.className+" ").indexOf(" "+classToCheck+" ")},getPixelValue:function(val){var valType=typeof val;return"number"===valType?val:"string"===valType?parseInt(val,10):0},valOrDefault:function(val,valDefault){return typeof val!==undefinedStr?val:valDefault},invokeCallbackArrayHelper:function(arr){var fn;if(Array.isArray(arr)&&"function"==typeof(fn=helpers[arr[0]]))return fn.apply(this,arr.slice(1))},invokeCallbackArray:function(arr){var i,len;if(Array.isArray(arr)){if("string"==typeof arr[0])return utils.invokeCallbackArrayHelper(arr);for(i=0,len=arr.length;i<len;++i)utils.invokeCallback(arr[i])}},invokeCallback:function(cb){return"function"==typeof cb?cb():"string"==typeof cb&&helpers[cb]?helpers[cb]():utils.invokeCallbackArray(cb)},invokeEventCallbacks:function(evtType,stepCb){var i,len,cbArr=callbacks[evtType];if(stepCb)return this.invokeCallback(stepCb);for(i=0,len=cbArr.length;i<len;++i)this.invokeCallback(cbArr[i].cb)},getScrollTop:function(){return typeof window.pageYOffset!==undefinedStr?window.pageYOffset:document.documentElement.scrollTop},getScrollLeft:function(){return typeof window.pageXOffset!==undefinedStr?window.pageXOffset:document.documentElement.scrollLeft},getWindowHeight:function(){return window.innerHeight||document.documentElement.clientHeight},addEvtListener:function(el,evtName,fn){if(el)return el.addEventListener?el.addEventListener(evtName,fn,!1):el.attachEvent("on"+evtName,fn)},removeEvtListener:function(el,evtName,fn){if(el)return el.removeEventListener?el.removeEventListener(evtName,fn,!1):el.detachEvent("on"+evtName,fn)},documentIsReady:function(){return"complete"===document.readyState},evtPreventDefault:function(evt){evt.preventDefault?evt.preventDefault():event&&(event.returnValue=!1)},extend:function(obj1,obj2){var prop;for(prop in obj2)obj2.hasOwnProperty(prop)&&(obj1[prop]=obj2[prop])},getStepTargetHelper:function(target){var result=document.getElementById(target);if(result)return result;if(hasJquery)return(result=jQuery(target)).length?result[0]:null;if(Sizzle)return(result=new Sizzle(target)).length?result[0]:null;if(document.querySelector)try{return document.querySelector(target)}catch(err){}return/^#[a-zA-Z][\w-_:.]*$/.test(target)?document.getElementById(target.substring(1)):null},getStepTarget:function(step){var queriedTarget;if(!step||!step.target)return null;if("string"==typeof step.target)return utils.getStepTargetHelper(step.target);if(Array.isArray(step.target)){var i,len;for(i=0,len=step.target.length;i<len;i++)if("string"==typeof step.target[i]&&(queriedTarget=utils.getStepTargetHelper(step.target[i])))return queriedTarget;return null}return step.target},getI18NString:function(key){return customI18N[key]||HopscotchI18N[key]},setState:function(name,value,days){var date,expires="";if(hasSessionStorage&&isStorageWritable)try{sessionStorage.setItem(name,value)}catch(err){isStorageWritable=!1,this.setState(name,value,days)}else hasSessionStorage&&sessionStorage.removeItem(name),days&&((date=new Date).setTime(date.getTime()+24*days*60*60*1e3),expires="; expires="+date.toGMTString()),document.cookie=name+"="+value+expires+"; path=/"},getState:function(name){var i,c,state,nameEQ=name+"=",ca=document.cookie.split(";");if(hasSessionStorage&&(state=sessionStorage.getItem(name)))return state;for(i=0;i<ca.length;i++){for(c=ca[i];" "===c.charAt(0);)c=c.substring(1,c.length);if(0===c.indexOf(nameEQ)){state=c.substring(nameEQ.length,c.length);break}}return state},clearState:function(name){hasSessionStorage?sessionStorage.removeItem(name):this.setState(name,"",-1)},normalizePlacement:function(step){!step.placement&&step.orientation&&(step.placement=step.orientation)},flipPlacement:function(step){if(step.isRtl&&!step._isFlipped){var prop,i,props=["orientation","placement"];for(i in step.xOffset&&(step.xOffset=-1*this.getPixelValue(step.xOffset)),props)prop=props[i],step.hasOwnProperty(prop)&&rtlMatches.hasOwnProperty(step[prop])&&(step[prop]=rtlMatches[step[prop]]);step._isFlipped=!0}}}).addEvtListener(window,"load",winLoadHandler),callbacks={next:[],prev:[],start:[],end:[],show:[],error:[],close:[]},helpers={},HopscotchI18N={stepNums:null,nextBtn:"Next",prevBtn:"Back",doneBtn:"Done",skipBtn:"Skip",closeTooltip:"Close"},customI18N={},(HopscotchBubble=function(opt){this.init(opt)}).prototype={isShowing:!1,currStep:undefined,setPosition:function(step){var bubbleBoundingHeight,bubbleBoundingWidth,boundingRect,top,left,arrowOffset,verticalLeftPosition,targetEl=utils.getStepTarget(step),el=this.element,arrowEl=this.arrowEl,arrowPos=step.isRtl?"right":"left";if(utils.flipPlacement(step),utils.normalizePlacement(step),bubbleBoundingWidth=el.offsetWidth,bubbleBoundingHeight=el.offsetHeight,utils.removeClass(el,"fade-in-down fade-in-up fade-in-left fade-in-right"),boundingRect=targetEl.getBoundingClientRect(),verticalLeftPosition=step.isRtl?boundingRect.right-bubbleBoundingWidth:boundingRect.left,"top"===step.placement)top=boundingRect.top-bubbleBoundingHeight-this.opt.arrowWidth,left=verticalLeftPosition;else if("bottom"===step.placement)top=boundingRect.bottom+this.opt.arrowWidth,left=verticalLeftPosition;else if("left"===step.placement)top=boundingRect.top,left=boundingRect.left-bubbleBoundingWidth-this.opt.arrowWidth;else{if("right"!==step.placement)throw new Error("Bubble placement failed because step.placement is invalid or undefined!");top=boundingRect.top,left=boundingRect.right+this.opt.arrowWidth}(arrowOffset="center"!==step.arrowOffset?utils.getPixelValue(step.arrowOffset):step.arrowOffset)?"top"===step.placement||"bottom"===step.placement?(arrowEl.style.top="",arrowEl.style[arrowPos]="center"===arrowOffset?Math.floor(bubbleBoundingWidth/2-arrowEl.offsetWidth/2)+"px":arrowOffset+"px"):"left"!==step.placement&&"right"!==step.placement||(arrowEl.style[arrowPos]="",arrowEl.style.top="center"===arrowOffset?Math.floor(bubbleBoundingHeight/2-arrowEl.offsetHeight/2)+"px":arrowOffset+"px"):(arrowEl.style.top="",arrowEl.style[arrowPos]=""),"center"===step.xOffset?left=boundingRect.left+targetEl.offsetWidth/2-bubbleBoundingWidth/2:left+=utils.getPixelValue(step.xOffset),"center"===step.yOffset?top=boundingRect.top+targetEl.offsetHeight/2-bubbleBoundingHeight/2:top+=utils.getPixelValue(step.yOffset),step.fixedElement||(top+=utils.getScrollTop(),left+=utils.getScrollLeft()),el.style.position=step.fixedElement?"fixed":"absolute",el.style.top=top+"px",el.style.left=left+"px"},render:function(step,idx,callback){var tourSpecificRenderer,customTourData,unsafe,currTour,totalSteps,totalStepsI18n,nextBtnText,isLast,i,opts,el=this.element;if(step?this.currStep=step:this.currStep&&(step=this.currStep),this.opt.isTourBubble?(currTour=winHopscotch.getCurrTour())&&(customTourData=currTour.customData,tourSpecificRenderer=currTour.customRenderer,step.isRtl=step.hasOwnProperty("isRtl")?step.isRtl:currTour.hasOwnProperty("isRtl")?currTour.isRtl:this.opt.isRtl,unsafe=currTour.unsafe,Array.isArray(currTour.steps)&&(totalSteps=currTour.steps.length,totalStepsI18n=this._getStepI18nNum(this._getStepNum(totalSteps-1)),isLast=this._getStepNum(idx)===this._getStepNum(totalSteps-1))):(customTourData=step.customData,tourSpecificRenderer=step.customRenderer,unsafe=step.unsafe,step.isRtl=step.hasOwnProperty("isRtl")?step.isRtl:this.opt.isRtl),nextBtnText=isLast?utils.getI18NString("doneBtn"):step.showSkip?utils.getI18NString("skipBtn"):utils.getI18NString("nextBtn"),utils.flipPlacement(step),utils.normalizePlacement(step),this.placement=step.placement,opts={i18n:{prevBtn:utils.getI18NString("prevBtn"),nextBtn:nextBtnText,closeTooltip:utils.getI18NString("closeTooltip"),stepNum:this._getStepI18nNum(this._getStepNum(idx)),numSteps:totalStepsI18n},buttons:{showPrev:utils.valOrDefault(step.showPrevButton,this.opt.showPrevButton)&&this._getStepNum(idx)>0,showNext:utils.valOrDefault(step.showNextButton,this.opt.showNextButton),showCTA:utils.valOrDefault(step.showCTAButton&&step.ctaLabel,!1),ctaLabel:step.ctaLabel,showClose:utils.valOrDefault(this.opt.showCloseButton,!0)},step:{num:idx,isLast:utils.valOrDefault(isLast,!1),title:step.title||"",content:step.content||"",isRtl:step.isRtl,placement:step.placement,padding:utils.valOrDefault(step.padding,this.opt.bubblePadding),width:utils.getPixelValue(step.width)||this.opt.bubbleWidth,customData:step.customData||{}},tour:{isTour:this.opt.isTourBubble,numSteps:totalSteps,unsafe:utils.valOrDefault(unsafe,!1),customData:customTourData||{}}},"function"==typeof tourSpecificRenderer)el.innerHTML=tourSpecificRenderer(opts);else if("string"==typeof tourSpecificRenderer){if(!winHopscotch.templates||"function"!=typeof winHopscotch.templates[tourSpecificRenderer])throw new Error('Bubble rendering failed - template "'+tourSpecificRenderer+'" is not a function.');el.innerHTML=winHopscotch.templates[tourSpecificRenderer](opts)}else if(customRenderer)el.innerHTML=customRenderer(opts);else{if(!winHopscotch.templates||"function"!=typeof winHopscotch.templates[templateToUse])throw new Error('Bubble rendering failed - template "'+templateToUse+'" is not a function.');el.innerHTML=winHopscotch.templates[templateToUse](opts)}for(children=el.children,numChildren=children.length,i=0;i<numChildren;i++)node=children[i],utils.hasClass(node,"hopscotch-arrow")&&(this.arrowEl=node);return el.style.zIndex="number"==typeof step.zindex?step.zindex:"",this._setArrow(step.placement),this.hide(!1),this.setPosition(step),callback&&callback(!step.fixedElement),this},_getStepNum:function(idx){var i,skippedStepsCount=0,skippedSteps=winHopscotch.getSkippedStepsIndexes(),len=skippedSteps.length;for(i=0;i<len;i++)skippedSteps[i]<idx&&skippedStepsCount++;return idx-skippedStepsCount},_getStepI18nNum:function(idx){var stepNumI18N=utils.getI18NString("stepNums");return stepNumI18N&&idx<stepNumI18N.length?idx=stepNumI18N[idx]:idx+=1,idx},_setArrow:function(placement){utils.removeClass(this.arrowEl,"down up right left"),"top"===placement?utils.addClass(this.arrowEl,"down"):"bottom"===placement?utils.addClass(this.arrowEl,"up"):"left"===placement?utils.addClass(this.arrowEl,"right"):"right"===placement&&utils.addClass(this.arrowEl,"left")},_getArrowDirection:function(){return"top"===this.placement?"down":"bottom"===this.placement?"up":"left"===this.placement?"right":"right"===this.placement?"left":void 0},show:function(){var self=this,fadeClass="fade-in-"+this._getArrowDirection(),fadeDur=1e3;return utils.removeClass(this.element,"hide"),utils.addClass(this.element,fadeClass),setTimeout(function(){utils.removeClass(self.element,"invisible")},50),setTimeout(function(){utils.removeClass(self.element,fadeClass)},fadeDur),this.isShowing=!0,this},hide:function(remove){var el=this.element;return remove=utils.valOrDefault(remove,!0),el.style.top="",el.style.left="",remove?(utils.addClass(el,"hide"),utils.removeClass(el,"invisible")):(utils.removeClass(el,"hide"),utils.addClass(el,"invisible")),utils.removeClass(el,"animate fade-in-up fade-in-down fade-in-right fade-in-left"),this.isShowing=!1,this},destroy:function(){var el=this.element;el&&el.parentNode.removeChild(el),utils.removeEvtListener(el,"click",this.clickCb)},_handleBubbleClick:function(evt){function findMatchRecur(el){return el===evt.currentTarget?null:utils.hasClass(el,"hopscotch-cta")?"cta":utils.hasClass(el,"hopscotch-next")?"next":utils.hasClass(el,"hopscotch-prev")?"prev":utils.hasClass(el,"hopscotch-close")?"close":findMatchRecur(el.parentElement)}var action;if("cta"===(action=findMatchRecur((evt=evt||window.event).target||evt.srcElement)))this.opt.isTourBubble||winHopscotch.getCalloutManager().removeCallout(this.currStep.id),this.currStep.onCTA&&utils.invokeCallback(this.currStep.onCTA);else if("next"===action)winHopscotch.nextStep(!0);else if("prev"===action)winHopscotch.prevStep(!0);else if("close"===action){if(this.opt.isTourBubble){var doEndCallback=winHopscotch.getCurrStepNum()===winHopscotch.getCurrTour().steps.length-1;utils.invokeEventCallbacks("close"),winHopscotch.endTour(!0,doEndCallback)}else this.opt.onClose&&utils.invokeCallback(this.opt.onClose),this.opt.id&&!this.opt.isTourBubble?winHopscotch.getCalloutManager().removeCallout(this.opt.id):this.destroy();utils.evtPreventDefault(evt)}},init:function(initOpt){var onWinResize,appendToBody,currTour,opt,el=document.createElement("div"),self=this,resizeCooldown=!1;this.element=el,opt={showPrevButton:defaultOpts.showPrevButton,showNextButton:defaultOpts.showNextButton,bubbleWidth:defaultOpts.bubbleWidth,bubblePadding:defaultOpts.bubblePadding,arrowWidth:defaultOpts.arrowWidth,isRtl:defaultOpts.isRtl,showNumber:!0,isTourBubble:!0},initOpt=typeof initOpt===undefinedStr?{}:initOpt,utils.extend(opt,initOpt),this.opt=opt,el.className="hopscotch-bubble animated",opt.isTourBubble?(currTour=winHopscotch.getCurrTour())&&utils.addClass(el,"tour-"+currTour.id):utils.addClass(el,"hopscotch-callout no-number"),onWinResize=function(){!resizeCooldown&&self.isShowing&&(resizeCooldown=!0,setTimeout(function(){self.setPosition(self.currStep),resizeCooldown=!1},100))},utils.addEvtListener(window,"resize",onWinResize),this.clickCb=function(evt){self._handleBubbleClick(evt)},utils.addEvtListener(el,"click",this.clickCb),this.hide(),utils.documentIsReady()?document.body.appendChild(el):(document.addEventListener?(appendToBody=function(){document.removeEventListener("DOMContentLoaded",appendToBody),window.removeEventListener("load",appendToBody),document.body.appendChild(el)},document.addEventListener("DOMContentLoaded",appendToBody,!1)):(appendToBody=function(){"complete"===document.readyState&&(document.detachEvent("onreadystatechange",appendToBody),window.detachEvent("onload",appendToBody),document.body.appendChild(el))},document.attachEvent("onreadystatechange",appendToBody)),utils.addEvtListener(window,"load",appendToBody))}},HopscotchCalloutManager=function(){var callouts={},calloutOpts={};this.createCallout=function(opt){var callout;if(!opt.id)throw new Error("Must specify a callout id.");if(!validIdRegEx.test(opt.id))throw new Error("Callout ID is using an invalid format. Use alphanumeric, underscores, and/or hyphens only. First character must be a letter.");if(callouts[opt.id])throw new Error("Callout by that id already exists. Please choose a unique id.");if(!utils.getStepTarget(opt))throw new Error("Must specify existing target element via 'target' option.");return opt.showNextButton=opt.showPrevButton=!1,opt.isTourBubble=!1,callout=new HopscotchBubble(opt),callouts[opt.id]=callout,calloutOpts[opt.id]=opt,callout.render(opt,null,function(){callout.show(),opt.onShow&&utils.invokeCallback(opt.onShow)}),callout},this.getCallout=function(id){return callouts[id]},this.removeAllCallouts=function(){var calloutId;for(calloutId in callouts)callouts.hasOwnProperty(calloutId)&&this.removeCallout(calloutId)},this.removeCallout=function(id){var callout=callouts[id];callouts[id]=null,calloutOpts[id]=null,callout&&callout.destroy()},this.refreshCalloutPositions=function(){var calloutId,callout,opts;for(calloutId in callouts)callouts.hasOwnProperty(calloutId)&&calloutOpts.hasOwnProperty(calloutId)&&(callout=callouts[calloutId],opts=calloutOpts[calloutId],callout&&opts&&callout.setPosition(opts))}},winHopscotch=new function(initOptions){var bubble,calloutMgr,opt,currTour,currStepNum,cookieTourId,cookieTourStep,_configure,self=this,skippedSteps={},cookieSkippedSteps=[],getBubble=function(setOptions){return bubble&&bubble.element&&bubble.element.parentNode||(bubble=new HopscotchBubble(opt)),setOptions&&utils.extend(bubble.opt,{bubblePadding:getOption("bubblePadding"),bubbleWidth:getOption("bubbleWidth"),showNextButton:getOption("showNextButton"),showPrevButton:getOption("showPrevButton"),showCloseButton:getOption("showCloseButton"),arrowWidth:getOption("arrowWidth"),isRtl:getOption("isRtl")}),bubble},destroyBubble=function(){bubble&&(bubble.destroy(),bubble=null)},getOption=function(name){return void 0===opt?defaultOpts[name]:utils.valOrDefault(opt[name],defaultOpts[name])},getCurrStep=function(){return!currTour||currStepNum<0||currStepNum>=currTour.steps.length?null:currTour.steps[currStepNum]},targetClickNextFn=function(){self.nextStep()},adjustWindowScroll=function(cb){var scrollEl,yuiAnim,yuiEase,direction,scrollIncr,scrollTimeoutFn,bubbleEl=getBubble().element,bubbleTop=utils.getPixelValue(bubbleEl.style.top),bubbleBottom=bubbleTop+utils.getPixelValue(bubbleEl.offsetHeight),targetBounds=utils.getStepTarget(getCurrStep()).getBoundingClientRect(),targetElTop=targetBounds.top+utils.getScrollTop(),targetElBottom=targetBounds.bottom+utils.getScrollTop(),targetTop=bubbleTop<targetElTop?bubbleTop:targetElTop,targetBottom=bubbleBottom>targetElBottom?bubbleBottom:targetElBottom,windowTop=utils.getScrollTop(),windowBottom=windowTop+utils.getWindowHeight(),scrollToVal=targetTop-getOption("scrollTopMargin");targetTop>=windowTop&&(targetTop<=windowTop+getOption("scrollTopMargin")||targetBottom<=windowBottom)?cb&&cb():getOption("smoothScroll")?typeof YAHOO!==undefinedStr&&typeof YAHOO.env!==undefinedStr&&typeof YAHOO.env.ua!==undefinedStr&&typeof YAHOO.util!==undefinedStr&&typeof YAHOO.util.Scroll!==undefinedStr?(scrollEl=YAHOO.env.ua.webkit?document.body:document.documentElement,yuiEase=YAHOO.util.Easing?YAHOO.util.Easing.easeOut:undefined,(yuiAnim=new YAHOO.util.Scroll(scrollEl,{scroll:{to:[0,scrollToVal]}},getOption("scrollDuration")/1e3,yuiEase)).onComplete.subscribe(cb),yuiAnim.animate()):hasJquery?jQuery("body, html").animate({scrollTop:scrollToVal},getOption("scrollDuration"),cb):(scrollToVal<0&&(scrollToVal=0),direction=windowTop>targetTop?-1:1,scrollIncr=Math.abs(windowTop-scrollToVal)/(getOption("scrollDuration")/10),(scrollTimeoutFn=function(){var scrollTop=utils.getScrollTop(),scrollTarget=scrollTop+direction*scrollIncr;if(direction>0&&scrollTarget>=scrollToVal||direction<0&&scrollTarget<=scrollToVal)return scrollTarget=scrollToVal,cb&&cb(),void window.scrollTo(0,scrollTarget);window.scrollTo(0,scrollTarget),utils.getScrollTop()!==scrollTop?setTimeout(scrollTimeoutFn,10):cb&&cb()})()):(window.scrollTo(0,scrollToVal),cb&&cb())},goToStepWithTarget=function(direction,cb){var step,goToStepFn;currStepNum+direction>=0&&currStepNum+direction<currTour.steps.length?(currStepNum+=direction,goToStepFn=function(){utils.getStepTarget(step)?(skippedSteps[currStepNum]&&delete skippedSteps[currStepNum],cb(currStepNum)):(skippedSteps[currStepNum]=!0,utils.invokeEventCallbacks("error"),goToStepWithTarget(direction,cb))},(step=getCurrStep()).delay?setTimeout(goToStepFn,step.delay):goToStepFn()):cb(-1)},changeStep=function(doCallbacks,direction){var step,origStep,wasMultiPage,changeStepCb,bubble=getBubble(),self=this;if(bubble.hide(),doCallbacks=utils.valOrDefault(doCallbacks,!0),(step=getCurrStep()).nextOnTargetClick&&utils.removeEvtListener(utils.getStepTarget(step),"click",targetClickNextFn),origStep=step,wasMultiPage=direction>0?origStep.multipage:currStepNum>0&&currTour.steps[currStepNum-1].multipage,changeStepCb=function(stepNum){var doShowFollowingStep;if(-1===stepNum)return this.endTour(!0);doCallbacks&&(doShowFollowingStep=direction>0?utils.invokeEventCallbacks("next",origStep.onNext):utils.invokeEventCallbacks("prev",origStep.onPrev)),stepNum===currStepNum&&(wasMultiPage?setStateHelper():(doShowFollowingStep=utils.valOrDefault(doShowFollowingStep,!0))?this.showStep(stepNum):this.endTour(!1))},!wasMultiPage&&getOption("skipIfNoElement"))goToStepWithTarget(direction,function(stepNum){changeStepCb.call(self,stepNum)});else if(currStepNum+direction>=0&&currStepNum+direction<currTour.steps.length){if(currStepNum+=direction,step=getCurrStep(),!utils.getStepTarget(step)&&!wasMultiPage)return utils.invokeEventCallbacks("error"),this.endTour(!0,!1);changeStepCb.call(this,currStepNum)}else if(currStepNum+direction===currTour.steps.length)return this.endTour();return this},loadTour=function(tour){var prop,tourState,tourStateValues,tmpOpt={};for(prop in tour)tour.hasOwnProperty(prop)&&"id"!==prop&&"steps"!==prop&&(tmpOpt[prop]=tour[prop]);return _configure.call(this,tmpOpt,!0),(tourState=utils.getState(getOption("cookieName")))&&(tourStateValues=tourState.split(":"),cookieTourId=tourStateValues[0],cookieTourStep=tourStateValues[1],tourStateValues.length>2&&(cookieSkippedSteps=tourStateValues[2].split(",")),cookieTourStep=parseInt(cookieTourStep,10)),this},findStartingStep=function(startStepNum,savedSkippedSteps,cb){var step,target;if(currStepNum=startStepNum||0,skippedSteps=savedSkippedSteps||{},step=getCurrStep(),target=utils.getStepTarget(step))cb(currStepNum);else if(!target){if(utils.invokeEventCallbacks("error"),skippedSteps[currStepNum]=!0,getOption("skipIfNoElement"))return void goToStepWithTarget(1,cb);cb(currStepNum=-1)}},showStepHelper=function(stepNum){function showBubble(){bubble.show(),utils.invokeEventCallbacks("show",step.onShow)}var step=currTour.steps[stepNum],bubble=getBubble(),targetEl=utils.getStepTarget(step);currStepNum!==stepNum&&getCurrStep().nextOnTargetClick&&utils.removeEvtListener(utils.getStepTarget(getCurrStep()),"click",targetClickNextFn),currStepNum=stepNum,bubble.hide(!1),bubble.render(step,stepNum,function(adjustScroll){adjustScroll?adjustWindowScroll(showBubble):showBubble(),step.nextOnTargetClick&&utils.addEvtListener(targetEl,"click",targetClickNextFn)}),setStateHelper()},setStateHelper=function(){var cookieVal=currTour.id+":"+currStepNum,skipedStepIndexes=winHopscotch.getSkippedStepsIndexes();skipedStepIndexes&&skipedStepIndexes.length>0&&(cookieVal+=":"+skipedStepIndexes.join(",")),utils.setState(getOption("cookieName"),cookieVal,1)},init=function(initOptions){initOptions&&this.configure(initOptions)};this.getCalloutManager=function(){return typeof calloutMgr===undefinedStr&&(calloutMgr=new HopscotchCalloutManager),calloutMgr},this.startTour=function(tour,stepNum){var currStepNum,skippedSteps={},self=this;if(!currTour){if(!tour)throw new Error("Tour data is required for startTour.");if(!tour.id||!validIdRegEx.test(tour.id))throw new Error("Tour ID is using an invalid format. Use alphanumeric, underscores, and/or hyphens only. First character must be a letter.");currTour=tour,loadTour.call(this,tour)}if(typeof stepNum!==undefinedStr){if(stepNum>=currTour.steps.length)throw new Error("Specified step number out of bounds.");currStepNum=stepNum}if(!utils.documentIsReady())return waitingToStart=!0,this;if(void 0===currStepNum&&currTour.id===cookieTourId&&typeof cookieTourStep!==undefinedStr){if(currStepNum=cookieTourStep,cookieSkippedSteps.length>0)for(var i=0,len=cookieSkippedSteps.length;i<len;i++)skippedSteps[cookieSkippedSteps[i]]=!0}else currStepNum||(currStepNum=0);return findStartingStep(currStepNum,skippedSteps,function(stepNum){-1!==stepNum&&utils.getStepTarget(currTour.steps[stepNum])?(utils.invokeEventCallbacks("start"),getBubble().hide(!1),self.isActive=!0,utils.getStepTarget(getCurrStep())?self.showStep(stepNum):(utils.invokeEventCallbacks("error"),getOption("skipIfNoElement")&&self.nextStep(!1))):self.endTour(!1,!1)}),this},this.showStep=function(stepNum){var step=currTour.steps[stepNum],prevStepNum=currStepNum;return utils.getStepTarget(step)?(step.delay?setTimeout(function(){showStepHelper(stepNum)},step.delay):showStepHelper(stepNum),this):(currStepNum=stepNum,utils.invokeEventCallbacks("error"),void(currStepNum=prevStepNum))},this.prevStep=function(doCallbacks){return changeStep.call(this,doCallbacks,-1),this},this.nextStep=function(doCallbacks){return changeStep.call(this,doCallbacks,1),this},this.endTour=function(clearState,doCallbacks){var currentStep,bubble=getBubble();return clearState=utils.valOrDefault(clearState,!0),doCallbacks=utils.valOrDefault(doCallbacks,!0),currTour&&(currentStep=getCurrStep())&&currentStep.nextOnTargetClick&&utils.removeEvtListener(utils.getStepTarget(currentStep),"click",targetClickNextFn),currStepNum=0,cookieTourStep=undefined,bubble.hide(),clearState&&utils.clearState(getOption("cookieName")),this.isActive&&(this.isActive=!1,currTour&&doCallbacks&&utils.invokeEventCallbacks("end")),this.removeCallbacks(null,!0),this.resetDefaultOptions(),destroyBubble(),currTour=null,this},this.getCurrTour=function(){return currTour},this.getCurrTarget=function(){return utils.getStepTarget(getCurrStep())},this.getCurrStepNum=function(){return currStepNum},this.getSkippedStepsIndexes=function(){var stepIds,skippedStepsIdxArray=[];for(stepIds in skippedSteps)skippedStepsIdxArray.push(stepIds);return skippedStepsIdxArray},this.refreshBubblePosition=function(){var currStep=getCurrStep();return currStep&&getBubble().setPosition(currStep),this.getCalloutManager().refreshCalloutPositions(),this},this.listen=function(evtType,cb,isTourCb){return evtType&&callbacks[evtType].push({cb:cb,fromTour:isTourCb}),this},this.unlisten=function(evtType,cb){var i,len,evtCallbacks=callbacks[evtType];for(i=0,len=evtCallbacks.length;i<len;++i)evtCallbacks[i].cb===cb&&evtCallbacks.splice(i,1);return this},this.removeCallbacks=function(evtName,tourOnly){var cbArr,i,len,evt;for(evt in callbacks)if(!evtName||evtName===evt)if(tourOnly)for(i=0,len=(cbArr=callbacks[evt]).length;i<len;++i)cbArr[i].fromTour&&(cbArr.splice(i--,1),--len);else callbacks[evt]=[];return this},this.registerHelper=function(id,fn){"string"==typeof id&&"function"==typeof fn&&(helpers[id]=fn)},this.unregisterHelper=function(id){helpers[id]=null},this.invokeHelper=function(id){var i,len,args=[];for(i=1,len=arguments.length;i<len;++i)args.push(arguments[i]);helpers[id]&&helpers[id].call(null,args)},this.setCookieName=function(name){return opt.cookieName=name,this},this.resetDefaultOptions=function(){return opt={},this},this.resetDefaultI18N=function(){return customI18N={},this},this.getState=function(){return utils.getState(getOption("cookieName"))},_configure=function(options,isTourOptions){var eventPropName,i,len,events=["next","prev","start","end","show","error","close"];for(opt||this.resetDefaultOptions(),utils.extend(opt,options),options&&utils.extend(customI18N,options.i18n),i=0,len=events.length;i<len;++i)options[eventPropName="on"+events[i].charAt(0).toUpperCase()+events[i].substring(1)]&&this.listen(events[i],options[eventPropName],isTourOptions);return getBubble(!0),this},this.configure=function(options){return _configure.call(this,options,!1)},this.setRenderer=function(render){var typeOfRender=typeof render;return"string"===typeOfRender?(templateToUse=render,customRenderer=undefined):"function"===typeOfRender&&(customRenderer=render),this},this.setEscaper=function(esc){return"function"==typeof esc&&(customEscape=esc),this},init.call(this,initOptions)},function(){var _={escape:function(str){return customEscape?customEscape(str):null==str?"":(""+str).replace(new RegExp("[&<>\"']","g"),function(match){return"&"==match?"&amp;":"<"==match?"&lt;":">"==match?"&gt;":'"'==match?"&quot;":"'"==match?"&#x27;":void 0})}};this.templates=this.templates||{},this.templates.bubble_default=function(data){function optEscape(str,unsafe){return unsafe?_.escape(str):str}var __t,__p="";_.escape,Array.prototype.join;__p+="\n";var i18n=data.i18n,buttons=data.buttons,step=data.step,tour=data.tour;return __p+='\n<div class="hopscotch-bubble-container" style="width: '+(null==(__t=step.width)?"":__t)+"px; padding: "+(null==(__t=step.padding)?"":__t)+'px;">\n  ',tour.isTour&&(__p+='<span class="hopscotch-bubble-number">'+(null==(__t=i18n.stepNum)?"":__t)+"</span>"),__p+='\n  <div class="hopscotch-bubble-content">\n    ',""!==step.title&&(__p+='<h3 class="hopscotch-title">'+(null==(__t=optEscape(step.title,tour.unsafe))?"":__t)+"</h3>"),__p+="\n    ",""!==step.content&&(__p+='<div class="hopscotch-content">'+(null==(__t=optEscape(step.content,tour.unsafe))?"":__t)+"</div>"),__p+='\n  </div>\n  <div class="hopscotch-actions">\n    ',buttons.showPrev&&(__p+='<button class="hopscotch-nav-button prev hopscotch-prev">'+(null==(__t=i18n.prevBtn)?"":__t)+"</button>"),__p+="\n    ",buttons.showCTA&&(__p+='<button class="hopscotch-nav-button next hopscotch-cta">'+(null==(__t=buttons.ctaLabel)?"":__t)+"</button>"),__p+="\n    ",buttons.showNext&&(__p+='<button class="hopscotch-nav-button next hopscotch-next">'+(null==(__t=i18n.nextBtn)?"":__t)+"</button>"),__p+="\n  </div>\n  ",buttons.showClose&&(__p+='<button class="hopscotch-bubble-close hopscotch-close">'+(null==(__t=i18n.closeTooltip)?"":__t)+"</button>"),__p+='\n</div>\n<div class="hopscotch-bubble-arrow-container hopscotch-arrow">\n  <div class="hopscotch-bubble-arrow-border"></div>\n  <div class="hopscotch-bubble-arrow"></div>\n</div>\n'}}.call(winHopscotch),winHopscotch}),function(){PollEv.namespace("PollEv.Tour",function(Tour){return Tour.Helper={onPageReady:function(){var initialRoute,userLoaded;return userLoaded=new $.Deferred(function(promise){return PollEv.app.user.isNew()?PollEv.app.user.once("change:login",function(){return promise.resolve()}):promise.resolve()}),initialRoute=new $.Deferred(function(promise){return PollEv.app.once("route",function(){return promise.resolve()})}),$.when(userLoaded.promise(),initialRoute.promise())},onVizReady:function(){return new $.Deferred(function(promise){return PollEv.app.once("ready",function(){var onMessage;return onMessage=function(e){if("finishedLoading"===e.data)return window.removeEventListener("message",onMessage,!1),promise.resolve()},window.addEventListener("message",onMessage,!1)})})},onMyPollsReady:function(){return new $.Deferred(function(promise){return PollEv.app.once("activity_selector:ready",promise.resolve)})},getMobileLink:function(){var login,pollevURL;return login=PollEv.app.user.get("login"),pollevURL=PollEv.env.get("mobile_url").path(login),$("<a>").attr("href",pollevURL.toString()).attr("target","_blank").attr("rel","noopener").text("PollEv.com/"+login.toUpperCase())},setLocalStorage:function(key,val){try{return localStorage.setItem(key,val)}catch(error){error}},getLocalStorage:function(key){var val;val=null;try{val=localStorage.getItem(key)}catch(error){error}return val}}})}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}};PollEv.namespace("PollEv.Tour",function(Tour){return Tour.Base=function(){function Base(){this.cleanup=bind(this.cleanup,this),this.toClean=[]}return Base.prototype.steps=function(){throw new Error("Must be implemented by subclass")},Base.prototype.start=function(step){return hopscotch.startTour(this.hopscotchConfig(),step)},Base.prototype.validRestartLink=function(){var restart_params;return restart_params=new RegExp("restart_tour="+this.id),window.location.search.substring(1).match(restart_params)},Base.prototype.inProgress=function(){var tourMatch;return(tourMatch=/([\w-]+):(\d+)/.exec(hopscotch.getState()))&&tourMatch[1]===this.id},
Base.prototype.hopscotchConfig=function(){return{id:this.id,steps:this.steps(),showPrevButton:!1,showNextButton:!1,scrollTopMargin:1e6,skipIfNoElement:!1,onNext:this.cleanup,onPrev:this.cleanup,onEnd:(_this=this,function(){return _this.cleanup()}),onClose:function(_this){return function(){if(_this.cleanup(),_this.optOut(_this.id),!_this.isComplete(_this.id))return PollEv.app.trigger("view:action","tour:close",{type:_this.id,step:hopscotch.getCurrStepNum()})}}(this),onStart:function(_this){return function(){return 0===hopscotch.getCurrStepNum()?PollEv.app.trigger("view:action","tour:start",{type:_this.id}):PollEv.app.trigger("view:action","tour:continue",{type:_this.id,step:hopscotch.getCurrStepNum()})}}(this)};var _this},Base.prototype.listenTo=function(obj,eventName,handler){return obj.on(eventName,handler),this.toClean.push(function(){return obj.off(eventName,handler)})},Base.prototype.addCleanup=function(task){return this.toClean.push(task)},Base.prototype.cleanup=function(){return _.each(this.toClean,function(item){return item()})},Base.prototype.setComplete=function(){return PollEv.app.trigger("view:action","tour:end",{type:this.id}),Tour.Helper.setLocalStorage("tour_complete_"+this.id,"1")},Base.prototype.isComplete=function(){return"1"===Tour.Helper.getLocalStorage("tour_complete_"+this.id)},Base.prototype.optOut=function(){return Tour.Helper.setLocalStorage("tour_opt_out_"+this.id,"1")},Base.prototype.hasOptedOut=function(){return"1"===Tour.Helper.getLocalStorage("tour_opt_out_"+this.id)},Base.prototype.onViewAction=function(event,action){return this.listenTo(PollEv.app,"view:action",function(eventName){if(eventName===event)return action.apply(this,arguments)})},Base.prototype.setCSS=function($el,css){return $el.data("origCss",$el.attr("style")),$el.css(css),this.toClean.push(function(){return $el.attr("style",$el.data("origCss")||"")})},Base.prototype.repositionOnScroll=function($el){return this.listenTo($el,"scroll",_.debounce(function(){return hopscotch.refreshBubblePosition()},50))},Base.prototype.repositionOnSelect=function($el){return this.listenTo($el,"click",_.debounce(function(){return hopscotch.refreshBubblePosition()},50))},Base.prototype.handleGenesis=function(){return this.repositionOnScroll($(".genesis-modal")),this.repositionOnSelect($(".genesis-modal .component-picker__btn")),this.onViewAction("activity_creator:close",function(){return hopscotch.endTour()})},Base}()})}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;PollEv.namespace("PollEv.Tour",function(Tour){return Tour.Competition=function(superClass){function Competition(){return this.steps=bind(this.steps,this),Competition.__super__.constructor.apply(this,arguments)}return extend(Competition,superClass),Competition.prototype.id="competition",Competition.prototype.canStart=function(){var isActivityEnabled,isAvailable,ref,ref1;return isActivityEnabled=null!=(ref=PollEv.app.user.get("features"))&&null!=(ref1=ref.activities)?ref1.competitions:void 0,isAvailable=window.AVAILABLE_TOUR===this.id&&isActivityEnabled,!this.isComplete()&&isAvailable||this.validRestartLink(this.id)},Competition.prototype.steps=function(){return[{target:".component-editor-title",placement:"top",content:"<p>Enter a title that describes the topic of the competition.</p>",width:230,onShow:(_this=this,function(){var $mcpTitle,$title,myStep,nextIfTitle;return myStep=hopscotch.getCurrStepNum(),$title=$(".component-editor-title input").first(),$mcpTitle=$(".component-editor-multiple-choice .component-editor-title input"),nextIfTitle=function(){if($title.val()&&myStep===hopscotch.getCurrStepNum())return hopscotch.nextStep()},_this.handleGenesis(),_this.listenTo($title,"input",_.debounce(nextIfTitle,800)),_this.listenTo($mcpTitle,"focus",nextIfTitle),$title.focus()})},{target:".component-editor-multiple-choice .component-editor-title input",placement:"top",content:"<p>Enter the first question for the competition.</p>",onShow:function(_this){return function(){var $options,$title,myStep,nextIfTitle;return myStep=hopscotch.getCurrStepNum(),$title=$(".component-editor-multiple-choice .component-editor-title input"),$options=$(".component-editor-multiple-choice__options input"),nextIfTitle=function(){if($title.val()&&myStep===hopscotch.getCurrStepNum())return hopscotch.nextStep()},_this.handleGenesis(),_this.listenTo($title,"input",_.debounce(nextIfTitle,800)),_this.listenTo($options,"focus",nextIfTitle),$title.focus()}}(this)},{target:".component-editor-multiple-choice__options",placement:"top",content:"<p>Enter at least two responses. Select the checkmark next to each correct response.</p>",onShow:function(_this){return function(){var $footerButtons,$options,debouncedCheck,myStep,nextIfOptions;return myStep=hopscotch.getCurrStepNum(),$options=$(".component-editor-multiple-choice__options"),$footerButtons=$(".component-activity-creator__footer button"),nextIfOptions=function(){if($options.find(".component-editor-multiple-choice__option__input").filter(function(){return $(this).val()}).length>1&&myStep===hopscotch.getCurrStepNum())return hopscotch.nextStep()},_this.addCleanup(function(){return $options.off("input","input",debouncedCheck)}),debouncedCheck=_.debounce(nextIfOptions,800),_this.handleGenesis(),_this.listenTo($footerButtons,"focus",function(){return nextIfOptions}),$options.on("input","input",debouncedCheck),$options.find("input").first().focus()}}(this)},{target:".component-activity-creator__create",placement:"left",content:'The competition is ready. Select "Create" to continue',yOffset:"center",arrowOffset:"center",multipage:!0,onShow:function(_this){return function(){return _this.handleGenesis(),_this.onViewAction("activity_creator:multiple_choice:add_option",function(){return hopscotch.refreshBubblePosition()}),_this.onViewAction("activity_creator:create",function(){return hopscotch.nextStep()})}}(this)},{target:".component-configurator-competition__play",placement:"bottom",content:'Select "Play" to begin. Use the right arrow key to advance. Follow the on-screen instructions to respond.',onShow:function(_this){return function(){return _this.setComplete(),$(".component-configurator-competition__play").on("click",hopscotch.endTour)}}(this)}];var _this},Competition}(Tour.Base)})}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;PollEv.namespace("PollEv.Tour",function(Tour){var finishedTourContent,finishedTourTarget;return finishedTourContent=function(){return document.cookie.match(/restart_tour=mcp/)?'<p>The chart updates, live.</p>\n<p>Let\'s pair your multiple choice question with a live word cloud to keep things interesting.</p>\n<p>\n  <button id="start-wordloud-prequel" class="btn-ghost">Make a word cloud</button>\n  <button id="start-wordloud-snooze" class="btn-ghost">Later</button>\n</p>':"<p>You finished the tutorial, and now your chart updates live. Great job!</p>"},finishedTourTarget=function(){return document.cookie.match(/restart_tour=mcp/)?"#main_menu li.polls-tab":"iframe.chart"},Tour.MultipleChoice=function(superClass){function MultipleChoice(){return this.steps=bind(this.steps,this),MultipleChoice.__super__.constructor.apply(this,arguments)}return extend(MultipleChoice,superClass),MultipleChoice.prototype.id="mcp",MultipleChoice.prototype.canStart=function(){var isAvailable;return isAvailable=window.AVAILABLE_TOUR===this.id,!this.hasOptedOut()&&!this.isComplete()&&isAvailable||this.validRestartLink(this.id)},MultipleChoice.prototype.steps=function(){return[{target:"#navigation .new-poll",placement:"right",content:'<p>We\'ll show you how to set up a polling activity. It takes about a minute.\n<p>Click "Create" to begin.',yOffset:-10,xOffset:-10,zindex:500,onShow:(_this=this,function(){if(_this.onViewAction("activity_creator:open",function(){return hopscotch.nextStep()}),_this.listenTo(PollEv.app,"route",function(route){if("newPoll"===route)return hopscotch.nextStep()}),_this.listenTo($("button.import-polls"),"click",function(){return hopscotch.endTour()}),$(".genesis-modal").is(":visible"))return hopscotch.nextStep()})},{target:".component-picker__btn[data-identifier=multiple-choice]",placement:"right",content:'<p>Let\'s create your first question.\n<p>First choose an activity type.\n<p>Select "Multiple choice".',yOffset:"center",arrowOffset:"center",onShow:function(_this){return function(){var $otherTypes,$title,$type;return _this.handleGenesis(),$(".component-picker__btn--featured").removeClass("component-picker__btn--featured"),$type=$('.component-picker__btn[data-identifier="multiple-choice"]'),_this.listenTo($type,"click",function(e){return e.stopPropagation(),hopscotch.nextStep()}),$title=$('.component-editor-multiple-choice .component-editor-title input[text="text"]'),_this.listenTo($title,"focus",function(e){return e.stopPropagation(),hopscotch.nextStep()}),$otherTypes=$(".component-picker__btn").not($type),_this.setCSS($otherTypes,{pointerEvents:"none"}),_this.setCSS($type,{cursor:"pointer"})}}(this)},{target:".component-editor-title",placement:"top",content:'<p>Type a question to ask the audience, or\n<p><button id="mcp-tour-fill" class="btn-ghost">Use an example</button>',width:230,onShow:function(_this){return function(){var $options,$title,myStep,nextIfTitle;return myStep=hopscotch.getCurrStepNum(),$title=$(".component-editor-title input"),nextIfTitle=function(){if($title.val()&&myStep===hopscotch.getCurrStepNum())return hopscotch.nextStep()},_this.handleGenesis(),_this.listenTo($title,"input",_.debounce(nextIfTitle,300)),$options=$(".component-editor-multiple-choice__options input"),_this.listenTo($options,"focus",nextIfTitle),_this.listenTo($("#mcp-tour-fill"),"click",function(e){return e.stopPropagation(),_this.cleanup(),$(".component-editor-title input").val("What's your favorite color?").trigger("input"),$(".component-editor-multiple-choice__option__input").eq(0).val("Red").trigger("input"),$(".component-editor-multiple-choice__option__input").eq(1).val("Blue").trigger("input"),$(".component-editor-multiple-choice__add button").trigger("click"),$(".component-editor-multiple-choice__option__input").eq(2).val("Green").trigger("input"),$(".component-activity-creator__create").focus(),hopscotch.showStep(myStep+2)})}}(this)},{target:".component-editor-multiple-choice",placement:"bottom",content:"<p>Type a few options for your audience to choose from.\n<p>Add at least two.",onShow:function(_this){return function(){var $footerButtons,$options,debouncedCheck,myStep,nextIfOptions;return myStep=hopscotch.getCurrStepNum(),$options=$(".component-editor-multiple-choice__options"),$footerButtons=$(".component-activity-creator__footer button"),nextIfOptions=function(){if($options.find(".component-editor-multiple-choice__option__input").filter(function(){return $(this).val()}).length>1&&myStep===hopscotch.getCurrStepNum())return hopscotch.nextStep()},_this.handleGenesis(),_this.onViewAction("activity_creator:multiple_choice:add_option",function(){return hopscotch.refreshBubblePosition()}),_this.onViewAction("activity_creator:multiple_choice:remove_option",function(){return hopscotch.refreshBubblePosition()}),_this.listenTo($footerButtons,"focus",function(){return nextIfOptions}),debouncedCheck=_.debounce(nextIfOptions,300),$options.on("input","input",debouncedCheck),_this.addCleanup(function(){return $options.off("input","input",debouncedCheck)})}}(this)},{target:".component-activity-creator__create",placement:"left",content:'Click "Create" to see the live response chart.',yOffset:"center",arrowOffset:"center",multipage:!0,onShow:function(_this){return function(){return _this.handleGenesis(),_this.onViewAction("activity_creator:multiple_choice:add_option",function(){return hopscotch.refreshBubblePosition()}),_this.onViewAction("activity_creator:create",function(){return hopscotch.nextStep()})}}(this)},{target:"iframe.chart",placement:"right",content:'<strong>Activate</strong> <span class="icon" data-glyph="push"></span>\nyour poll, making it available to your audience here:\n<p class="tour__external_link">\n  <a href="https://pollev.com/USER_NAME" target="_blank" rel="noopener">PollEv.com/USER_NAME</a>\n</p>',width:260,yOffset:50,xOffset:-30,onShow:function(_this){return function(){var login,pollevURL;return login=PollEv.app.user.get("login"),pollevURL=PollEv.env.get("mobile_url").path(login),$(".tour__external_link a").attr("href",pollevURL.toString()).text("PollEv.com/"+login.toUpperCase()),_this.listenTo(PollEv.app.view.show.model,"change:current",function(_,current){if(current)return hopscotch.nextStep()})}}(this)},{target:".wizard-steps .step-two",placement:"bottom",content:"Let's try responding to your question, just like an audience member would.",width:260,xOffset:"center",arrowOffset:"center",onShow:function(_this){return function(){return _this.listenTo(PollEv.app,"changeStep",function(step){if(".test-poll"===step)return hopscotch.nextStep()})}}(this)},{target:".iphone-frame",placement:"left",content:"Respond by clicking one of the options.",width:260,yOffset:150,onShow:function(_this){return function(){return _this.listenTo(PollEv.app.view.show.model,"change:results_count",function(){return hopscotch.nextStep()})}}(this)},{target:finishedTourTarget(),placement:"right",content:finishedTourContent(),width:260,xOffset:-19,onShow:function(_this){return function(){return _this.setComplete(),_this.listenTo($("#start-wordloud-prequel"),"click",function(e){return e.stopPropagation(),hopscotch.endTour(),hopscotch.getCalloutManager().createCallout({id:"wordcloud-prequel",target:"#main_menu .polls-tab",placement:"bottom",content:"First navigate back to your list of polls"})}),_this.listenTo($("#start-wordloud-snooze"),"click",function(e){return e.stopPropagation(),(new Tour.WordCloud).snooze(),hopscotch.endTour()})}}(this)}];var _this},MultipleChoice.prototype.optOut=function(){return Tour.Helper.setLocalStorage("tour_opt_out","1")},MultipleChoice.prototype.hasOptedOut=function(){return"1"===Tour.Helper.getLocalStorage("tour_opt_out")},MultipleChoice}(Tour.Base)})}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;PollEv.namespace("PollEv.Tour",function(Tour){var SNOOZE_DAYS;return SNOOZE_DAYS=2,Tour.WordCloud=function(superClass){function WordCloud(){return this.steps=bind(this.steps,this),WordCloud.__super__.constructor.apply(this,arguments)}return extend(WordCloud,superClass),WordCloud.prototype.id="word-cloud",WordCloud.prototype.snooze=function(){var snoozeUntil;return snoozeUntil=XDate().addDays(SNOOZE_DAYS).toUTCString(),Tour.Helper.setLocalStorage("tour_snooze_{@id}",snoozeUntil)},WordCloud.prototype.canStart=function(){var isAvailable,isSnoozed,ref,ref1,snoozeUntil;return isSnoozed=(snoozeUntil=PollEv.Tour.Helper.getLocalStorage("tour_snooze_{@id}"))&&XDate(snoozeUntil).diffDays()<0,isAvailable=window.AVAILABLE_TOUR===this.id,!!(null!=(ref=PollEv.app.user.get("features"))&&null!=(ref1=ref.activities)?ref1.free_text_polls:void 0)&&!this.hasOptedOut()&&!this.isComplete()&&isAvailable&&!isSnoozed||this.validRestartLink(this.id)},WordCloud.prototype.steps=function(){return[{target:"#navigation .new-poll",placement:"bottom",content:'<p>Word clouds are our most captivating visual experience.\n<p>Click "Create" to begin.',yOffset:-10,xOffset:-10,zindex:500,onShow:(_this=this,function(){if(_this.onViewAction("activity_creator:open",function(){return hopscotch.nextStep()}),_this.listenTo($("button.import-polls"),"click",function(){return hopscotch.endTour()}),$(".genesis-modal").is(":visible"))return hopscotch.endTour()})},{target:".component-picker__btn[data-identifier=word-cloud]",placement:"right",content:'<p>First choose the activity type.\n<p>Select "Word cloud".',yOffset:"center",arrowOffset:"center",onShow:function(_this){return function(){var $otherTypes,$type;return _this.handleGenesis(),$(".component-picker__btn--featured").removeClass("component-picker__btn--featured"),_this.onViewAction("activity_creator:change_type",function(_,data){if("word-cloud"===data.type)return hopscotch.nextStep()}),$type=$('.component-picker__btn[data-identifier="word-cloud"]'),$otherTypes=$(".component-picker__btn").not($type),_this.setCSS($otherTypes,{pointerEvents:"none"}),_this.setCSS($type,{cursor:"pointer"})}}(this)},{target:".component-editor-title",placement:"bottom",content:'<p>Type a question to ask the audience, or\n<p><button id="word-cloud-tour-fill" class="btn-ghost">Use an example</button>',width:230,onShow:function(_this){return function(){var $title,myStep,nextIfTitle;return myStep=hopscotch.getCurrStepNum(),$title=$(".component-editor-title input"),nextIfTitle=function(){if($title.val()&&myStep===hopscotch.getCurrStepNum())return hopscotch.nextStep()},_this.handleGenesis(),_this.listenTo($title,"input",_.debounce(nextIfTitle,300)),_this.listenTo($("#word-cloud-tour-fill"),"click",function(e){return e.stopPropagation(),$(".component-editor-title input").val("What one word would you use to describe yourself?").trigger("input")})}}(this)},{target:".component-activity-creator__create",placement:"left",content:'Click "Create" to see the live response chart.',yOffset:"center",arrowOffset:"center",multipage:!0,onShow:function(_this){return function(){return _this.handleGenesis(),_this.onViewAction("activity_creator:create",function(){return hopscotch.nextStep()})}}(this)},{target:"iframe.chart",placement:"right",content:'<strong>Activate</strong> <span class="icon" data-glyph="push"></span>\nyour poll, making it available to your audience here:\n<p class="tour__external_link"></p>',width:260,yOffset:50,xOffset:-30,onShow:function(_this){return function(){return $(".tour__external_link").append(Tour.Helper.getMobileLink()),_this.listenTo(PollEv.app.view.show.model,"change:current",function(_,current){if(current)return hopscotch.nextStep()})}}(this)},{target:".wizard-steps .step-two",placement:"bottom",content:"Let's try responding to your question, just like an audience member would.",width:260,xOffset:"center",arrowOffset:"center",onShow:function(_this){return function(){return _this.listenTo(PollEv.app,"changeStep",function(step){if(".test-poll"===step)return hopscotch.nextStep()})}}(this)},{target:".iphone-frame",placement:"left",content:'<p>Submit a few responses<span id="word-cloud-tour-progress"></span>.</p>',width:260,yOffset:150,onShow:function(_this){return function(){return _this.listenTo(PollEv.app.view.show.model,"change:results_count",function(_,count){return count>2?count>2?hopscotch.nextStep():void 0:$("#word-cloud-tour-progress").text(" ("+(3-count)+" more)")})}}(this)},{target:"iframe.chart",placement:"right",content:'<p>Nice! This works really well for larger audiences.\n<p>Don\'t forget to check out our <a href="/support">support</a> section for more tips.',width:260,xOffset:-19,onShow:function(_this){return function(){return _this.setComplete()}}(this)}];var _this},WordCloud}(Tour.Base)})}.call(this),function(){var setTourActiveHack,startTour;setTourActiveHack=function(){try{return window.sessionStorage.setItem("hopscotch_active_hack",!0)}catch(error){}},startTour=function(tour,bootstrapStep){return tour.inProgress()?tour.start():tour.canStart()?tour.start(bootstrapStep):void 0},$(function(){var Tour;return(Tour=PollEv.Tour).Helper.onPageReady().then(function(){var competitionTour,mcpTour,path,wordCloudTour;return path=PollEv.app.location(),mcpTour=new Tour.MultipleChoice,wordCloudTour=new Tour.WordCloud,competitionTour=new Tour.Competition,path.match(/my\/polls$/)?Tour.Helper.onMyPollsReady().then(function(){return mcpTour.canStart()?mcpTour.start():wordCloudTour.canStart()?wordCloudTour.start():competitionTour.canStart()?PollEv.app.on("view:action",function(event,selected){if("activity_creator:change_type"===event&&"competition"===selected.type)return competitionTour.start()}):void 0}):path.match(/multiple_choice_polls/)?(setTourActiveHack(),Tour.Helper.onVizReady().then(function(){return startTour(mcpTour,5)})):path.match(/free_text_polls/)?(setTourActiveHack(),Tour.Helper.onVizReady().then(function(){return startTour(wordCloudTour,4)})):/competitions/gi.test(path)?(setTourActiveHack(),Tour.Helper.onVizReady().then(function(){return startTour(competitionTour,4)})):void 0})})}.call(this);