(function(){var slice=[].slice;window.HAML=function(){function HAML(){}return HAML.escape=function(text){return(""+text).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/\//g,"&#47;")},HAML.cleanValue=function(text){switch(text){case null:case void 0:return"";case!0:case!1:return"\x93"+text;default:return text}},HAML.extend=function(){var i,key,len,obj,source,sources,val;for(obj=arguments[0],i=0,len=(sources=2<=arguments.length?slice.call(arguments,1):[]).length;i<len;i++)for(key in source=sources[i])val=source[key],obj[key]=val;return obj},HAML.globals=function(){return{}},HAML.context=function(locals){return this.extend({},HAML.globals(),locals)},HAML.preserve=function(text){return text.replace(/\n/g,"&#x000A;")},HAML.findAndPreserve=function(text){var tags;return tags="textarea,pre".split(",").join("|"),text.replace(/\r/g,"").replace(RegExp("<("+tags+")>([\\s\\S]*?)<\\/\\1>","g"),function(str,tag,content){return"<"+tag+">"+window.HAML.preserve(content)+"</"+tag+">"})},HAML.surround=function(start,end,fn){var ref;return start+(null!=(ref=fn.call(this))?ref.replace(/^\s+|\s+$/g,""):void 0)+end},HAML.succeed=function(end,fn){var ref;return(null!=(ref=fn.call(this))?ref.replace(/\s+$/g,""):void 0)+end},HAML.precede=function(start,fn){var ref;return start+(null!=(ref=fn.call(this))?ref.replace(/^\s+/g,""):void 0)},HAML.reference=function(object,prefix){var id,name,ref;if(name=prefix?prefix+"_":"","function"==typeof object.hamlObjectRef?name+=object.hamlObjectRef():name+=((null!=(ref=object.constructor)?ref.name:void 0)||"object").replace(/\W+/g,"_").replace(/([a-z\d])([A-Z])/g,"$1_$2").toLowerCase(),id="function"==typeof object.to_key?object.to_key():"function"==typeof object.id?object.id():object.id?object.id:object)return"class='"+name+"'"+" id='"+name+"_"+id+"'"},HAML}()}).call(this),function(){PollEv.namespace("PollEv.RailsApp.Util",function(Util){return Util.select_all=function(element){var $el;return($el=$(element)).focus(),$el.select(),$el},Util.randomString=function(length){var id;for(id="";id.length<length;)id+=Math.random().toString(36).substr(2);return id.substr(0,length)},Util.makeJob=function(attributes,url,name){var job;return(job=new PollEv.Model.Job).save(attributes,{url:url}).then(function(){return job.set({uuid:URI(job.get("job_url")).segment(-1)}),job.pollingInterval=1,job.startChecking()}).fail(function(xhr,status,error){return job.trigger("fail",error)}),job.on("fail",function(data){var description;return description="Job Failed",name&&(description+=": "+name),"undefined"!=typeof rollbar&&null!==rollbar?rollbar.error(description,{data:attributes,url:url,error:data}):void 0}),job}})}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;PollEv.namespace("PollEv.Views",function(Views){return Views.Base=function(superClass){function Base(){return this.show=bind(this.show,this),this.hide=bind(this.hide,this),Base.__super__.constructor.apply(this,arguments)}return extend(Base,superClass),Base.prototype.initialize=function(opts){return Base.__super__.initialize.apply(this,arguments),this.options=opts,this.el=$(this.el)},Base.prototype.hide=function(){return this.el.hide()},Base.prototype.show=function(){return this.el.show()},Base}(PollEv.View.Base)})}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;window.ParticipantsIndicatorView=function(superClass){function ParticipantsIndicatorView(){return this.hideSmall=bind(this.hideSmall,this),this.updateCounter=bind(this.updateCounter,this),this.pollForChanges=bind(this.pollForChanges,this),this.render=bind(this.render,this),ParticipantsIndicatorView.__super__.constructor.apply(this,arguments)}return extend(ParticipantsIndicatorView,superClass),ParticipantsIndicatorView.prototype.el="#participants_tab_container",ParticipantsIndicatorView.prototype.events={"click .delete":"render"},ParticipantsIndicatorView.prototype.initialize=function(opts){return this.url=opts.url,this.count=opts.initial_count,this.render(),this.pollForChanges()},ParticipantsIndicatorView.prototype.render=function(){return this.indicator=$("<div>").addClass("participants_indicator bottom_right_tip").attr("tip",'This is the number of people in your audience who are following along on your PollEv.com page from their smartphones, tablets, and other web enabled devices. <br/><a href="/pollev">Learn more</a>'),this.$el.append(this.indicator),PollEverywhereUtils.qtipize(this.indicator),this.indicator.text(this.count),this.hideSmall()},ParticipantsIndicatorView.prototype.pollForChanges=function(){return setInterval((_this=this,function(){return $.getJSON(_this.url,function(json){return _this.updateCounter(json.count.toString())})}),3e5);var _this},ParticipantsIndicatorView.prototype.updateCounter=function(count){if(this.indicator.text()!==count)return this.indicator.fadeTo(700,.2,(_this=this,function(){if(_this.indicator.text(count),_this.hideSmall(),_this.indicator.is(":visible"))return _this.indicator.fadeTo(700,1)}));var _this},ParticipantsIndicatorView.prototype.hideSmall=function(){return parseInt(this.indicator.text())<5?this.indicator.hide():this.indicator.show()},ParticipantsIndicatorView}(Backbone.View)}.call(this);